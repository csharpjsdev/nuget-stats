@using NuGet

@{
    var repo = new DataServicePackageRepository(new Uri("http://packages.nuget.org/v1/FeedService.svc"));    
    var packages = repo.GetPackages().ToList();

    Response.Write(Json.Encode(new
    {
        TotalCount = packages.Count,
        UniqueCount = packages.GroupBy(p => p.Id).Count(),
        TotalDownloads = packages.GroupBy(p => p.Id).Select(g => g.First().DownloadCount).Sum(),
    }));
}